<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Detalhes do Edital</title>
    <style>
        body { font-family: sans-serif; }
        .container { max-width: 800px; margin: auto; padding: 20px; border: 1px solid #ccc; border-radius: 5px; }
        .section { margin-top: 30px; }
        .detail-item { margin-bottom: 10px; }
        .detail-item strong { display: inline-block; width: 200px; }
        table { width: 100%; border-collapse: collapse; margin-top: 15px; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
        th { background-color: #f2f2f2; }
        .btn { padding: 5px 10px; background-color: #007bff; color: white; text-decoration: none; border-radius: 3px;}
    </style>
</head>
<body>
    <div class="container">
        <h1>{{ edital.titulo }}</h1>
        
        <div class="detail-item"><strong>Número do Edital:</strong> {{ edital.numero_edital }}</div>
        <div class="detail-item"><strong>Status:</strong> {{ edital.status }}</div>
        <div class="detail-item"><strong>Unidade Demandante:</strong> {{ edital.unidade_demandante_nome }}</div>
        <div class="detail-item"><strong>Data de Início:</strong> {{ edital.data_inicio|date:"d/m/Y" }}</div>
        <div class="detail-item"><strong>Data de Fim:</strong> {{ edital.data_fim|date:"d/m/Y" }}</div>
        <div class="detail-item"><strong>Valor do Empenho:</strong> R$ {{ edital.valor_empenho|floatformat:2 }}</div>
        <div class="detail-item">
            <strong>Descrição:</strong>
            <div>{{ edital.descricao|linebreaks }}</div>
        </div>
        
        <hr>
        <a href="{% url 'editar_edital' pk=edital.pk %}">Editar Edital</a> | 
        <a href="{% url 'listar_editais' %}">Voltar para a Lista</a>

        <div class="section">
            <h2>Atividades do Edital</h2>
            <a href="{% url 'adicionar_atividade' edital_pk=edital.pk %}" class="btn">Adicionar Nova Atividade</a>
            <table>
                <thead>
                    <tr>
                        <th>Nome</th>
                        <th>Valor por Hora</th>
                        <th>Servidores Alocados</th> <th>Ações</th>
                    </tr>
                </thead>
                <tbody>
                    {% for atividade in atividades %}
                    <tr>
                        <td>{{ atividade.tipo.nome }}</td>
                        <td>R$ {{ atividade.tipo.valor_hora|floatformat:2 }}</td>
                        <td>{{ atividade.servidores_alocados.count }}</td> 
                        <td>
                            <a href="{% url 'alocar_servidores' pk=atividade.pk %}">Alocar Servidores</a> |
                            <a href="{% url 'editar_atividade' pk=atividade.pk %}">Editar</a> |
                            <form action="{% url 'remover_atividade' pk=atividade.pk %}" method="POST" style="display: inline;">
                                {% csrf_token %}
                                <button type="submit" onclick="return confirm('Tem certeza que deseja remover esta atividade?')" style="background:none; border:none; color:blue; cursor:pointer; padding:0; text-decoration:underline;">
                                    Remover
                                </button>
                            </form>
                        </td>
                    </tr>
                    {% empty %}
                    <tr>
                        <td colspan="4">Nenhuma atividade cadastrada para este edital.</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</body>
</html>